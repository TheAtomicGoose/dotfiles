#!/usr/bin/ruby
require 'open-uri'
require 'nokogiri'

print "Please enter the subreddit you would like to see links from: "
subreddit = gets.chomp

# Loops forever
while true do

  # Getting the file
  doc = Nokogiri::XML(open("http://www.reddit.com/r/#{subreddit}.rss"))

  item_length = doc.xpath("//item").length

  (item_length > 18 ? 18 : item_length).times do |item|

    # Having "//item//title" and "//item//link" instead of "//title" and "//link" makes sure that 
    # titles and links are only taken if they are subtags of an item tag

    # title = the title of the current item
    title = doc.xpath("//item//title")[item]
    # link = the link to the current item
    link = doc.xpath("//item//link")[item]

    # Prints title and link stripped of tags
    puts title.text.gsub(/<.*?\/?>/, '') 
    puts link.text.gsub(/<.*?\/?>/, '') 
    puts "\n"
  end
  # Waits two hours before redoing
  sleep(3600) 
  puts "\n\n\n\n"
end
